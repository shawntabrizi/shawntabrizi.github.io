<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Blog | Shawn Tabrizi</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://shawntabrizi.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://shawntabrizi.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://shawntabrizi.com/blog/page/3/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | Shawn Tabrizi"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/assets/favicon/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://shawntabrizi.com/blog/page/3/"><link data-rh="true" rel="alternate" href="https://shawntabrizi.com/blog/page/3/" hreflang="en"><link data-rh="true" rel="alternate" href="https://shawntabrizi.com/blog/page/3/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Shawn Tabrizi RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Shawn Tabrizi Atom Feed"><link rel="stylesheet" href="/assets/css/styles.a4fb03fe.css">
<script src="/assets/js/runtime~main.ce7a45d3.js" defer="defer"></script>
<script src="/assets/js/main.f3fd7040.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Shawn Tabrizi</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/donate/">Donate</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/shawntabrizi/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/personal/web3-reading-list/">Web3 Reading List</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/substrate/transparent-keys-in-substrate/">Transparent Keys in Substrate</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/substrate/substrate-weight-and-fees/">Substrate Weights and Fees</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/substrate/porting-web3-js-to-polkadot-js/">Porting Web3.js to Polkadot.js</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/substrate/substrate-storage-deep-dive/">Substrate Storage Deep Dive</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="In this post I will discuss how I used MSAL.js to build a simple sign-in experience for Microsoft Identities, and some of the things I learned along the way."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/aad/building-a-simple-sign-in-page-with-msal-js-for-microsoft-identities/">Building a Simple Sign-In Page with MSAL.js for Microsoft Identities</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2018-08-01T06:25:43.000Z" itemprop="datePublished">August 1, 2018</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/shawntabrizi.png" alt="Shawn Tabrizi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shawn Tabrizi</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h5 class="anchor anchorWithStickyNavbar_LWe7" id="in-this-post-i-will-discuss-how-i-used-msaljs-to-build-a-simple-sign-in-experience-for-microsoft-identities-and-some-of-the-things-i-learned-along-the-way">In this post I will discuss how I used MSAL.js to build a simple sign-in experience for Microsoft Identities, and some of the things I learned along the way.<a href="#in-this-post-i-will-discuss-how-i-used-msaljs-to-build-a-simple-sign-in-experience-for-microsoft-identities-and-some-of-the-things-i-learned-along-the-way" class="hash-link" aria-label="Direct link to In this post I will discuss how I used MSAL.js to build a simple sign-in experience for Microsoft Identities, and some of the things I learned along the way." title="Direct link to In this post I will discuss how I used MSAL.js to build a simple sign-in experience for Microsoft Identities, and some of the things I learned along the way.">​</a></h5>
<p>I have worked with a lot of different people to onboard to Microsoft&#x27;s Identity system. Whether it be app registration, app development, or even debugging the login experience, people quickly learn that authentication and authorization isn&#x27;t always as straightforward as one might expect.</p>
<p>It is for that reason I think it is really important to build <a href="https://stackoverflow.com/help/mcve" target="_blank" rel="noopener noreferrer">minimal, complete, and verifiable examples</a> of the authentication process. I previously had built a minimal authentication sample for <a href="https://github.com/shawntabrizi/Azure-AD-Authentication-with-PowerShell-and-ADAL" target="_blank" rel="noopener noreferrer">ADAL .NET using PowerShell</a>, and <a href="https://shawntabrizi.com/aad/azure-ad-authentication-with-powershell-and-adal/" target="_blank" rel="noopener noreferrer">this ended up having a number of different uses</a>.</p>
<p>I want to do the same for MSAL.js!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="my-goals">My goals:<a href="#my-goals" class="hash-link" aria-label="Direct link to My goals:" title="Direct link to My goals:">​</a></h2>
<ul>
<li>Create a login page</li>
<li>Use only basic HTML + JavaScript</li>
<li>Does not require a &#x27;web server&#x27;, just simple web hosting</li>
<li>Can obtain an Access Token for a custom resource, with custom scopes</li>
<li>(Stretch Goal) Allow a user to use their own App ID for getting an access token</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="starting-with-a-minimal-example">Starting with a Minimal example<a href="#starting-with-a-minimal-example" class="hash-link" aria-label="Direct link to Starting with a Minimal example" title="Direct link to Starting with a Minimal example">​</a></h2>
<p>Fortunately, MSAL.js has a set of really great <a href="https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/lib/msal-core/samples/VanillaJSTestApp" target="_blank" rel="noopener noreferrer">minimal examples</a> which do not require a back-end web server, unlike its predecessor ADAL.js whose <a href="https://github.com/AzureAD/azure-activedirectory-library-for-js/wiki/Code-samples" target="_blank" rel="noopener noreferrer">samples</a> ALL require a .NET backend. (WHY???)</p>
<p>Although there is a <code>minimal.html</code> file, I would not start there, since I do not feel that it follows the best practices of using the library. Instead, start with the <a href="https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-core/samples/VanillaJSTestApp/index.html" target="_blank" rel="noopener noreferrer"><code>index.html</code></a> which is still very raw, but includes an <code>applicationConfig</code> object, functionalizes the login flow, and also has a basic UX.</p>
<p>One of the important things I came to realize was the importance of creating a global variable for the <code>MSAL.UserAgentApplication</code> object. It seems to do a lot of different things like listen for the callback from the popup window that gets created, and captures the returned ID and access token to be ingested by the <code>acquireToken</code> functions. I had mistakenly wrapped this variable into my login function, and the results were... weird.</p>
<p>When using the popup experience, the redirection happened WITHIN the popup itself rather than the main page where the sign-in experience was initiated.</p>
<p><img loading="lazy" src="/assets/images/img_5b614c4d2d483-6b02bba16e67c8dfce6668836f6cb71b.png" width="1274" height="1110" class="img_ev3q"></p>
<p>This was a really awful experience, which then made me go down the path of switching <code>loginPopup</code> to <code>loginRedirect</code> so that the user would stay on the same page the whole time. However, this then caused issues where the ID token would just end up in the URL as a fragment (<code>#</code>) and the callback function which turned an ID token into an access token would not work anymore!</p>
<p>When I first was building this page, I actually ignored these problems, since I was working on a Hackathon, and I just needed to keep building. However, I can say that all of this really was caused simply by NOT having the <code>UserAgentApplication</code> object in the global context.</p>
<p>SO DON&#x27;T DO THAT!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-working-sample">A working sample<a href="#a-working-sample" class="hash-link" aria-label="Direct link to A working sample" title="Direct link to A working sample">​</a></h2>
<p>You can find the end result of my simple sign-in page here:</p>
<p><a href="https://shawntabrizi.com/Microsoft-Authentication-with-MSAL.js/" target="_blank" rel="noopener noreferrer">https://shawntabrizi.com/Microsoft-Authentication-with-MSAL.js/</a></p>
<p>Source code is on <a href="https://github.com/shawntabrizi/Microsoft-Authentication-with-MSAL.js" target="_blank" rel="noopener noreferrer">GitHub</a>.</p>
<p><img loading="lazy" src="/assets/images/img_5b614ec708ba1-df099a1c7c4e5667082147a86e91286f.png" width="1790" height="775" class="img_ev3q"></p>
<p>The page currently will sign you in, and get an access token to the Microsoft Graph with the scope <code>user.read</code>. Additionally, it will show you your ID token and access token as both a raw JWT and in its decoded JSON format, which I teach how to do <a href="https://shawntabrizi.com/aad/decoding-jwt-tokens/" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>Besides showing off MSAL.js in a really simple website, I think this app will be useful when trying to use other tools like Postman where you will need to have a valid access token, and generating one may not be so straight forward to the end user.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next steps" title="Direct link to Next steps">​</a></h2>
<p>While this sample in its current form is pretty cool, it does not satisfy all the goals I listed above. That will be the next step for me on this project. I still need to figure out exactly how to call a custom API using a V2 application (which may not even be possible to configure right now until a new UX which a co-worker of mine is working on becomes available). However, allowing a user to input custom scopes should be really easy, and if others configure their own App ID to have my website as a redirect url, then I could see using a custom App ID to be really easy too.</p>
<p>I will be making this updates in the same <a href="https://github.com/shawntabrizi/Microsoft-Authentication-with-MSAL.js" target="_blank" rel="noopener noreferrer">GitHub</a> I listed above, and you should see the changes directly on the <a href="https://shawntabrizi.com/Microsoft-Authentication-with-MSAL.js/" target="_blank" rel="noopener noreferrer">same page as before</a>! I hope this was useful for some of you, and if there are additional things I could add to make this project work better for you, just let me know through a GitHub issue.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/authentication/">authentication</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/azure-active-directory/">azure active directory</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/javascript/">javascript</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/msal/">msal</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="My favorite time of the year at Microsoft is the &quot;OneWeek&quot; Hackathon."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/aad/microsoft-identities-on-the-ethereum-blockchain/">Microsoft Identities on the Ethereum Blockchain</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2018-07-01T06:08:30.000Z" itemprop="datePublished">July 1, 2018</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/shawntabrizi.png" alt="Shawn Tabrizi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shawn Tabrizi</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>My favorite time of the year at Microsoft is the &quot;OneWeek&quot; Hackathon.</p>
<p><img loading="lazy" alt="Hackathon Image" src="/assets/images/img_5b386bd8dab8a-3bc02633fda412eab69cff854f234b9d.png" width="842" height="544" class="img_ev3q"></p>
<p>It&#x27;s a time of the year where you can work with some of the most talented engineers around to solve problems that you all agree are awesome.</p>
<p>I have lead a <a href="https://shawntabrizi.com/metime/" target="_blank" rel="noopener noreferrer">different</a> <a href="https://shawntabrizi.com/Skill-Finder/" target="_blank" rel="noopener noreferrer">project</a> every year, some of which have been hinted to in my <a href="https://shawntabrizi.com/code/scraping-linkedin-topics-skills-data/" target="_blank" rel="noopener noreferrer">previous blog posts.</a></p>
<p>This year will be no different.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hypothesis-microsofts-identity-system-has-value-which-can-be-transferred-to-the-ethereum-blockchain">Hypothesis: Microsoft&#x27;s identity system has value which can be transferred to the Ethereum blockchain<a href="#hypothesis-microsofts-identity-system-has-value-which-can-be-transferred-to-the-ethereum-blockchain" class="hash-link" aria-label="Direct link to Hypothesis: Microsoft&#x27;s identity system has value which can be transferred to the Ethereum blockchain" title="Direct link to Hypothesis: Microsoft&#x27;s identity system has value which can be transferred to the Ethereum blockchain">​</a></h2>
<p>One of the amazing things about identities on Ethereum is that they are free, anonymous, and simple to create. However this also makes them pretty useless when trying to gate access to decentralized applications. There are solutions to combat this problem if you to build a reputation or token staking system around your application, but this usually involves a new identity to undergo significant onboarding before their identity becomes valuable. What if instead of completely recreating new identities, we could bootstrap them using our existing, modern identities?</p>
<p>There is value in Microsoft Identities. I don&#x27;t mean specifically &quot;Microsoft.com accounts&quot;, I mean the identity system that is built by Microsoft, and is used by <a href="https://shawntabrizi.com/aad/does-company-x-have-an-azure-active-directory-tenant/" target="_blank" rel="noopener noreferrer">85% of the Fortune 500</a>. If a user has an account in the Adobe company tenant, then we can pretty confidently say the following:</p>
<ul>
<li>That user is an employee of Adobe</li>
<li>That user&#x27;s identity is managed by a Company Administrator at Adobe</li>
<li>That user&#x27;s information first name, last name, phone number, etc. is relatively accurate</li>
<li>and more...</li>
</ul>
<p>This is actually the very information which powers Microsoft cloud services like Azure, Office 365, and the larger Microsoft Graph ecosystem. It is the same information that millions of apps use to build authentication and single-sign. There is trust because Microsoft has spent the time and energy to build a system with rigorous role based access control (RBAC), and companies have spent their time and energy populating these systems with data which powers their companies.</p>
<p>My hypothesis is that there is value in these Microsoft identities, simply for existing. Not all of them are equally valuable, but for large companies who methodically manage and control that information, the value is actually quite high. The question is then: &quot;How can we migrate this value onto Ethereum?&quot;</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-an-attestation-service">Building an attestation service<a href="#building-an-attestation-service" class="hash-link" aria-label="Direct link to Building an attestation service" title="Direct link to Building an attestation service">​</a></h2>
<p>Decentralized identity systems being developed on Ethereum are attempting to solve a number of critically important problems, however they are not attempting to replace all forms of centralization. There will always be some amount of centralization involved with adding claims or attestations to an identity. For example, if you want to prove that you are a US citizen, you will need to go to your state&#x27;s DMV to get an ID card.</p>
<p>In this case, we are interested in employment, and if you want to prove that your are an employee of a certain company, you will need to prove that you are registered within their internal systems. Imagine a middle tier service that accepts a valid authentication token, and associates that with an Ethereum address that the user provides. Then, if you can then make these proofs easily accessible, you then unlock a number of possibilities for dApps to take advantage of that information. Imagine the following user stories:</p>
<ul>
<li>An Ethereum address may want to prove who they are (Name, Company, Role, etc…). They could do this by logging into their corporate Azure Active Directory, and store those claims on the blockchain tied to their account.</li>
<li>Imagine Microsoft (or another company) wants to build a “Kudos” currency which can be used to thank other Microsoft Employees when they do nice things for one another. However, it should only be used between Microsoft employees. Using this identity claim, a smart contract which runs this cryptocurrency could verify that only Microsoft employees are the senders and recipients of the currency.</li>
<li>Imagine Microsoft (or another company) wants to build a decentralized market similar to SellBuy (a Microsoft internal alias for selling items) using the Ethereum blockchain. Similar to the other stories, this decentralized market should only allow people from Microsoft, or other trusted companies to join and list their products on the marketplace. So, the dApp uses these Microsoft Identity claims to gate access to the marketplace.</li>
<li>Imagine a decentralized application like <a href="https://www.teamblind.com/" target="_blank" rel="noopener noreferrer">Blind</a>, where users from different companies can anonymously chat within their own personal and shared forums. On Ethereum, an app like this can be completely censorship free and immutable, a problem that is present with the current Blind app. To ensure that these anonymous users have the right company identifier, we would use the claims about their accounts stored on the blockchain.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-plan">The plan<a href="#the-plan" class="hash-link" aria-label="Direct link to The plan" title="Direct link to The plan">​</a></h2>
<p><img loading="lazy" alt="High level architecture" src="/assets/images/img_5b527aea81ca1-bab6e05f6c37c5f5f33ac6734a63368d.png" width="1385" height="863" class="img_ev3q"></p>
<p>The plan for the hackathon is actually relatively simple, mostly because we will be executing a proof of concept versus a battle tested, production ready design. Let&#x27;s dive deeper into the pieces of the puzzle:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web-front-end">Web Front End<a href="#web-front-end" class="hash-link" aria-label="Direct link to Web Front End" title="Direct link to Web Front End">​</a></h3>
<p>The sign up process:</p>
<ul>
<li>The user goes to our web front end, and iniates a Microsoft identity login flow</li>
<li>This results in an app + user access token for our middle tier resource, signed by Microsoft&#x27;s identity provider</li>
<li>The user then signs this access token with their Ethereum private key</li>
<li>The web front end then sends a payload to the middle tier service with the access token and the signature for that payload</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="middle-tier-service">Middle Tier Service<a href="#middle-tier-service" class="hash-link" aria-label="Direct link to Middle Tier Service" title="Direct link to Middle Tier Service">​</a></h3>
<p>Registering the user:</p>
<ul>
<li>The middle tier service will recieve a &quot;doubly signed&quot; message, where the entire JWT is signed by the Ethereum address, and the contents of the JWT are signed by Microsoft</li>
<li>It will verify that the token&#x27;s resource is for the middle tier</li>
<li>It will verify that the token was signed by Microsoft</li>
<li>It will verify that the payload has been signed by the Ethereum account</li>
<li>It will parse out specific claims about the user that it wants to store on the blockchain (MVP is Tenant ID)</li>
<li>It will generate a transaction to our back end smart contract to store this data on Ethereum</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="back-end-identity-contract">Back End Identity Contract<a href="#back-end-identity-contract" class="hash-link" aria-label="Direct link to Back End Identity Contract" title="Direct link to Back End Identity Contract">​</a></h3>
<p>Storing the identity information:</p>
<ul>
<li>The back end identity contract will be owned by the middle tier service</li>
<li>It will define an extensible user object</li>
<li>It will have a mapping between Ethereum accounts and that user object</li>
<li>It will expose a getter function for other contracts to access that data</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="corpcoin-contract">CorpCoin Contract<a href="#corpcoin-contract" class="hash-link" aria-label="Direct link to CorpCoin Contract" title="Direct link to CorpCoin Contract">​</a></h3>
<p>Testing our identity system:</p>
<ul>
<li>The CorpCoin contract will be a basic ERC20 token</li>
<li>It will have a requirement that users have to be from a certain company/tenant to interact with the coin</li>
<li>It will interact with our back end identity contract to verify the user&#x27;s company/tenant</li>
<li>It will issue coins to users who have not been issued coins in the past to bootstrap the &#x27;economy&#x27;</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="more-to-come">More to come!<a href="#more-to-come" class="hash-link" aria-label="Direct link to More to come!" title="Direct link to More to come!">​</a></h2>
<p>That is all I am ready to share for now, but note that this is just a very high level overview. There are so many intricacies and details to think about when solving this problem. Here are just a few:</p>
<ul>
<li>How can we automatically remove claims of a user once their off-chain identity has been deleted or removed from a particular group/claim?</li>
<li>How can we store identity claims on the blockchain such that it does not expose sensitive information about the user to people who they do not want to share it with?</li>
<li>What default claims should we be storing, and how can we allow users to extend those claims for their own needs?</li>
<li>How could we decentralize the middle tier service which verifies the user’s Microsoft Identity, to increase trust that the claims stored on the blockchain are real?</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="watch-this-video-to-learn-more">Watch this video to learn more!<a href="#watch-this-video-to-learn-more" class="hash-link" aria-label="Direct link to Watch this video to learn more!" title="Direct link to Watch this video to learn more!">​</a></h2>
<iframe src="https://www.youtube.com/embed/Wg6kg2mLA3k" width="720px" height="480px"></iframe></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/azure-active-directory/">azure active directory</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/blockchain/">blockchain</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ethereum/">ethereum</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/identity/">identity</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/microsoft/">microsoft</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="In this tutorial, you will learn how to subscribe to an Ethereum WebSocket using Web3.js to dynamically pull pending transactions on the blockchain."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/ethereum/using-web3-js-1-0-subscribe-and-infura-websockets-to-visualize-ethereum-transactions/">Using Web3.js 1.0 Subscribe and Infura WebSockets to Visualize Ethereum Transactions</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2018-05-25T06:42:19.000Z" itemprop="datePublished">May 25, 2018</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/shawntabrizi.png" alt="Shawn Tabrizi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shawn Tabrizi</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h5 class="anchor anchorWithStickyNavbar_LWe7" id="in-this-tutorial-you-will-learn-how-to-subscribe-to-an-ethereum-websocket-using-web3js-to-dynamically-pull-pending-transactions-on-the-blockchain">In this tutorial, you will learn how to subscribe to an Ethereum WebSocket using Web3.js to dynamically pull pending transactions on the blockchain.<a href="#in-this-tutorial-you-will-learn-how-to-subscribe-to-an-ethereum-websocket-using-web3js-to-dynamically-pull-pending-transactions-on-the-blockchain" class="hash-link" aria-label="Direct link to In this tutorial, you will learn how to subscribe to an Ethereum WebSocket using Web3.js to dynamically pull pending transactions on the blockchain." title="Direct link to In this tutorial, you will learn how to subscribe to an Ethereum WebSocket using Web3.js to dynamically pull pending transactions on the blockchain.">​</a></h5>
<p>Recently, I have been pretty lurking on the <a href="https://ethereum.stackexchange.com/" target="_blank" rel="noopener noreferrer">Ethereum StackExchange</a>, and I have been seeing a pretty common question repeat itself.</p>
<blockquote>
<p>How can I detect when a specific transaction occurs on Ethereum?</p>
</blockquote>
<p>It might be that the user wants to see every time their account gets a payment. Or maybe they want track when another contract sends Ether.</p>
<p>By trying to answer this question I learned in <a href="https://web3js.readthedocs.io/en/1.0/index.html" target="_blank" rel="noopener noreferrer">Web3.js 1.0</a> is introducing support for WebSockets, which will allow client applications to have an open and interactive session with the Ethereum blockchain. With WebSockets, you can automatically receive event-driven responses from Ethereum without having to repeatedly poll the blockchain. (<em>As of this writing, Web3.js 1.0 is still in beta.</em>)</p>
<p>As of right now, you can <a href="https://web3js.readthedocs.io/en/1.0/web3-eth-subscribe.html" target="_blank" rel="noopener noreferrer">subscribe to 4 kinds of events</a>: <code>pendingTransactions</code>, <code>newBlockHeaders</code>, <code>syncing</code>, and <code>logs</code>.</p>
<p>Logs are particularly interesting because you can add additional <code>options</code> like an Ethereum address to only get back the logs for that account, which will allow you to really easily monitor when different events happen, such as a payment.</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> subscription </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;logs&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">address</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x123456..&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">topics</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;0x12345...&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">log</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;changed&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">log</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// unsubscribes the subscription</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subscription</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">unsubscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> success</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">success</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Successfully unsubscribed!&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="eth-transaction-graph">ETH Transaction Graph<a href="#eth-transaction-graph" class="hash-link" aria-label="Direct link to ETH Transaction Graph" title="Direct link to ETH Transaction Graph">​</a></h2>
<p>I wanted try out this feature, so I decided I would build a little visual which would show transactions on the Ethereum blockchain. I thought it would be cool to let transactions come in, and see if we can start to find addresses which have a ton of activity. A natural visual for transactions is to <a href="https://en.wikipedia.org/wiki/Graph_drawing" target="_blank" rel="noopener noreferrer">draw a graph</a>, and if we do things correctly, we should see these central nodes appear; where tons of different addresses are interacting with a single Ethereum contract or other type of account.</p>
<p>You can check out the web app I built here: <a href="https://shawntabrizi.com/ETH-Transaction-Graph/" target="_blank" rel="noopener noreferrer">https://shawntabrizi.com/ETH-Transaction-Graph/</a>.
Letting it run for a little bit will generate a neat <a href="https://en.wikipedia.org/wiki/Force-directed_graph_drawing" target="_blank" rel="noopener noreferrer">force-directed graph drawing</a> like the one below:</p>
<p><img loading="lazy" alt="Graph Drawing Result" src="/assets/images/img_5b07a77621420-4bfa96558b6d2d2b86f32819464bfec0.png" width="740" height="771" class="img_ev3q"></p>
<p>You can find the source code to this app on <a href="https://github.com/shawntabrizi/ETH-Transaction-Graph" target="_blank" rel="noopener noreferrer">my GitHub</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-it-work">How does it work?<a href="#how-does-it-work" class="hash-link" aria-label="Direct link to How does it work?" title="Direct link to How does it work?">​</a></h3>
<p>Before you can do anything with Web3.js, you will need to gain access to an Ethereum WebSocket. This technology is still pretty new, so there aren&#x27;t many options. But you can always rely on <a href="https://infura.io/" target="_blank" rel="noopener noreferrer">Infura</a> to be ahead of the game. Although as of this writing, <a href="https://github.com/INFURA/infura/issues/97" target="_blank" rel="noopener noreferrer">WebSockets on Infura are not quite production ready</a>, they should be in the near future. Connecting to the WebSocket is easy:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> web3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Web3</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;wss://mainnet.infura.io/_ws&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em>Note that it is important you do not include the normal check for <a href="https://metamask.io/" target="_blank" rel="noopener noreferrer">MetaMask</a>, since the browser plugin does not yet support WebSockets.</em></p>
<p>Now that you are connected to your WebSocket, you just need to set up a subscription using Web3.js:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">subscription </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;pendingTransactions&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">transactionHash</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getTransaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">transactionHash</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">transaction</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">createNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">transaction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword module" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> transaction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">to</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Using the code above, I will get a stream of transactions hashes coming to my app. Whenever I get a transaction hash, I use <code>web3.eth.getTransaction</code> to then get data about the transaction. Finally, from that data, I get the <code>to</code> address and the <code>from</code> address. These go into my <code>createNode</code> function which adds the transaction to the graph drawing. I won&#x27;t be going into much details about <a href="https://d3js.org/" target="_blank" rel="noopener noreferrer">D3.js</a>, which generates the graph, because it is black magic to me. (Lots of copy and pasting code to get this sample to work...)</p>
<p>If you are setting up a subscription, don&#x27;t forget to also set up a way to unsubscribe! This is particularly important for my little sample because the browser starts to get REALLY slow once you have a few thousand transactions drawn.</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">subscription</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">unsubscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> success</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">success</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Successfully unsubscribed!&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>That&#x27;s really all you need to know to set up a sample similar to this! I wanted to keep this example as dead simple as possible, but you could imagine a million ways to modify and improve the design here. For example, imagine having each node grow and shrink as Ether is sent to and from the Ethereum Address! If you want to fork my code, I would love to see what kinds of projects you can think of using my sample as a baseline.</p>
<p>As always, I am excited to share with you fun, simple projects in the Ethereum development space, and I would love to hear any and all feedback you have. Know a cool project that you think someone should build and write about? Let me know!</p>
<p>If this post helped you, and you want to say &quot;Thanks!&quot;, take a look at my <a href="https://shawntabrizi.com/donate/" target="_blank" rel="noopener noreferrer">donations page</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/blockchain/">blockchain</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ethereum/">ethereum</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/graph/">graph</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/html/">html</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/infura/">infura</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/javascript/">javascript</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/web-3/">web3</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/websockets/">websockets</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="In this post I will be summarizing some of the key takeaways from lessons 1 - 5 of the popular CryptoZombies tutorial. This should cover all of the Solidity aspects of building a CryptoKitties clone."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/ethereum/shawn-notes-cryptozombies-lessons-1-5-in-solidity/">Shawn Notes: CryptoZombies Lessons 1 &amp;#8211; 5 in Solidity</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2018-04-23T09:02:26.000Z" itemprop="datePublished">April 23, 2018</time> · <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/shawntabrizi.png" alt="Shawn Tabrizi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shawn Tabrizi</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h5 class="anchor anchorWithStickyNavbar_LWe7" id="in-this-post-i-will-be-summarizing-some-of-the-key-takeaways-from-lessons-1---5-of-the-popular-cryptozombies-tutorial-this-should-cover-all-of-the-solidity-aspects-of-building-a-cryptokitties-clone">In this post I will be summarizing some of the key takeaways from lessons 1 - 5 of the popular <a href="https://cryptozombies.io" target="_blank" rel="noopener noreferrer">CryptoZombies tutorial</a>. This should cover all of the Solidity aspects of building a CryptoKitties clone.<a href="#in-this-post-i-will-be-summarizing-some-of-the-key-takeaways-from-lessons-1---5-of-the-popular-cryptozombies-tutorial-this-should-cover-all-of-the-solidity-aspects-of-building-a-cryptokitties-clone" class="hash-link" aria-label="Direct link to in-this-post-i-will-be-summarizing-some-of-the-key-takeaways-from-lessons-1---5-of-the-popular-cryptozombies-tutorial-this-should-cover-all-of-the-solidity-aspects-of-building-a-cryptokitties-clone" title="Direct link to in-this-post-i-will-be-summarizing-some-of-the-key-takeaways-from-lessons-1---5-of-the-popular-cryptozombies-tutorial-this-should-cover-all-of-the-solidity-aspects-of-building-a-cryptokitties-clone">​</a></h5>
<p>This post should not act as a replacement for taking the course, which I strongly recommend you do. Instead this will be a good way to keep some of the new concepts and best practices fresh in your mind if you are jumping into a new Solidity project. This post will be written assuming that the reader is relatively versed in other programming languages so things like the modular function, if/else statements, and for loops wont be included.</p>
<p>Really I want to use this post as a way for me to look back and refresh my memory the next time I jump on a Solidity project.</p>
<p>So let&#x27;s get started!</p>
<p><img loading="lazy" src="/assets/images/img_5add32b676792-af10f97b235546d70006b52afda0c688.png" width="618" height="1093" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lesson-1-summary">Lesson 1 Summary<a href="#lesson-1-summary" class="hash-link" aria-label="Direct link to Lesson 1 Summary" title="Direct link to Lesson 1 Summary">​</a></h2>
<ul>
<li>
<p>Use <code>pragma solidity ^</code> to define the version of Solidity you want to use</p>
</li>
<li>
<p>Create a contract using <code>contract contractName {}</code></p>
</li>
<li>
<p><code>uint</code> is an alias for <code>uint256</code>. You can also individually specify <code>uint8</code>, <code>uint16</code>, etc...</p>
</li>
<li>
<p>Exponential operator in Solidity is <code>**</code>, i.e. <code>uint x = 5 **2; // equal to 5^2 = 25</code></p>
</li>
<li>
<p>Structs are available in Solidity and can be defined like:</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">struct Person {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	uint age;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	string name;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Fixed (<code>uint[2] fixedArray</code>)  and dynamic arrays (<code>uint[] dynamicArray</code>) are both available in Solidity.</p>
</li>
<li>
<p>You can also create an array of structs.</p>
</li>
<li>
<p>If you declare an array as <code>public</code>, Solidity will automatically create a getter method for it.</p>
</li>
<li>
<p>You can define a function within a contract like so:</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">function eatHamburgers(string _name, uint _amount) {...}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>It is convention to start function parameter variable names with an underscore (<code>_</code>), differentiating them from global variables.</p>
</li>
<li>
<p>Functions are <code>public</code> by default, which means anyone can call them. Usually you want to mark your functions <code>private</code> by default, and only make functions public if you want to expose them to others. We also start private functions with an underscore (<code>_</code>) by convention.</p>
</li>
<li>
<p>You need to declare the type of value a function will return if it returns a value like so:</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">function sayHello() public returns (string) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	return greeting;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>If a function does not change any values or write anything, we can additionally label the function as a <code>view</code> function.</p>
</li>
<li>
<p>If the function doesn&#x27;t even read from the state of the app, and only uses the function parameters we can label it <code>pure</code>.</p>
</li>
<li>
<p>Both <code>view</code> and <code>pure</code> functions can help users save gas when using your contract. More about this in lesson 3.</p>
</li>
<li>
<p>Typecasting is available in Solidity by wrapping a variable with the type, i.e. <code>uint8(var)</code>.</p>
</li>
<li>
<p>You can use events to communicate that something has happened on the blockchain. This is particularly useful when creating a front-end for your Solidity application.</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// declare the event</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">event IntegersAdded(uint x, uint y, uint result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function add(uint _x, uint _y) public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	uint result = _x + _y;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// fire an event to let the app know the function was called:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	IntegersAdded(_x, _y, result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	return result;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lesson-2-summary">Lesson 2 Summary<a href="#lesson-2-summary" class="hash-link" aria-label="Direct link to Lesson 2 Summary" title="Direct link to Lesson 2 Summary">​</a></h2>
<ul>
<li>
<p>In Solidity, there is a variable type <code>address</code>, that is a unique id to represent an Ethereum account.</p>
</li>
<li>
<p>Solidity has the concept of a <code>mapping</code>, which is like a hash table, <a href="https://solidity.readthedocs.io/en/develop/types.html#mappings" target="_blank" rel="noopener noreferrer">but a little different</a>.</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// For a financial app, storing a uint that holds the user&#x27;s account balance:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mapping (address =&gt; uint) public accountBalance;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>You can use <code>msg.sender</code> to refer to the address of the person or smart contract that called a particular function.</p>
</li>
<li>
<p>We can make functions throw an error if a condition is not true using <code>require();</code>.</p>
</li>
<li>
<p>You can use the inheritance phrase <code>is</code> to split up your contracts into a more object-oriented design.</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract Doge {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	function catchphrase() public returns (string) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	return &quot;So Wow CryptoDoge&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract BabyDoge is Doge {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	function anotherCatchphrase() public returns (string) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	return &quot;Such Moon BabyDoge&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>You can also split up your code into multiple files using the <code>import</code> keyword, referencing the other Solidity files.</p>
</li>
<li>
<p>There are two places you can store variables: <code>storage</code> and <code>memory</code>.  <code>storage</code> being permanently written information in the blockchain, and <code>memory</code> being temporary data which disappears at the end of a function call.</p>
</li>
<li>
<p>In addition to <code>public</code> and <code>private</code>, functions can also be <code>internal</code> or <code>external</code>. <code>internal</code> is the same as <code>private</code> except that it is also accessible to contracts which inherit from the one that contains this function. <code>external</code> is similar to <code>public</code> except that they can only be called outside the contract, not by functions inside the contract.</p>
</li>
<li>
<p>You can define an <code>interface</code> to allow one contract to talk to another that we do not own.</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">interface NumberInterface {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	function getNum(address _myAddress) public view returns (uint);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contract MyContract {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	address NumberInterfaceAddress = 0xab38...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// ^ The address of the FavoriteNumber contract on Ethereum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	NumberInterface numberContract = NumberInterface(NumberInterfaceAddress);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// Now `numberContract` is pointing to the other contract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	function someFunction() public {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		// Now we can call `getNum` from that contract:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		uint num = numberContract.getNum(msg.sender);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		// ...and do something with `num` here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>You can have functions return multiple variables and do multiple assignments using this format:</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">function multipleReturns() internal returns(uint a, uint b, uint c) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	return (1, 2, 3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function processMultipleReturns() external {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	uint a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	uint b;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	uint c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// This is how you do multiple assignment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	(a, b, c) = multipleReturns();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Or if we only cared about one of the values:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function getLastReturnValue() external {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	uint c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// We can just leave the other fields blank:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	(,,c) = multipleReturns();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lesson-3-summary">Lesson 3 Summary<a href="#lesson-3-summary" class="hash-link" aria-label="Direct link to Lesson 3 Summary" title="Direct link to Lesson 3 Summary">​</a></h2>
<ul>
<li>
<p>Ethereum contracts are immutable, so it may make sense to break apart your project into multiple contracts, where individual parts could get updated later by referencing a new contract with updated code.</p>
</li>
<li>
<p>It is common practice to add ownership to contracts. One such library that adds this functionality out of the box is <a href="https://github.com/OpenZeppelin/zeppelin-solidity/blob/master/contracts/ownership/Ownable.sol" target="_blank" rel="noopener noreferrer">OpenZeppelin&#x27;s Ownable.sol</a>.</p>
</li>
<li>
<p>Constructors are a special kind of function that has the same name as the contract and will only execute one time: when the contract is first created.</p>
</li>
<li>
<p>A <code>modifier</code> is logic that can be applied on top of a function, usually to check requirements before the function actually executes.</p>
</li>
<li>
<p>Function <code>modifier</code>s can also accept arguments.</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// A mapping to store a user&#x27;s age:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mapping (uint =&gt; uint) public age;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Modifier that requires this user to be older than a certain age:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modifier olderThan(uint _age, uint _userId) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	require(age[_userId] &gt;= _age);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Must be older than 16 to drive a car (in the US, at least).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// We can call the `olderThan` modifier with arguments like so:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function driveCar(uint _userId) public olderThan(16, _userId) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	// Some function logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Transactions on Ethereum are not free, and running functions or storing values on the blockchain require <code>gas</code>.</p>
</li>
<li>
<p>Normally, Solidity will reserve 256 bits of storage no matter what variable sub-type you use, so you will not save on gas.</p>
</li>
<li>
<p>The exception to this rule is in a <code>struct</code>, where Solidity will package multiple smaller variables together.</p>
</li>
<li>
<p>Solidity uses unix time, and has built into the language time units like <code>seconds</code>, <code>minutes</code>, <code>hours</code>, <code>days</code>, <code>weeks</code>, <code>years</code>.</p>
</li>
<li>
<p>You can also call <code>now</code>, which will return the current unix time for that block.</p>
</li>
<li>
<p>Earlier we mentioned that we can label functions with <code>view</code> if they are read only functions. Solidity also makes <code>view</code> functions free to call, therefore, wherever possible, make sure to make your functions <code>external view</code>. The same applies to <code>pure</code> functions.</p>
</li>
<li>
<p>When you write to <code>storage</code>, it takes a ton of gas. The tutorial states:</p>
<blockquote>
<p>In order to keep costs down, you want to avoid writing data to storage except when absolutely necessary. Sometimes this involves seemingly inefficient programming logic — like rebuilding an array in <code>memory</code> every time a function is called instead of simply saving that array in a variable for quick lookups.</p>
</blockquote>
</li>
<li>
<p>With the current version of Solidity, <code>memory</code> arrays must be fixed length.</p>
</li>
<li>
<p>CryptoZombies then talks about the correct way to implement mapping zombies to owners, it is a little long so I won&#x27;t summarize it here.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lesson-4-summary">Lesson 4 Summary<a href="#lesson-4-summary" class="hash-link" aria-label="Direct link to Lesson 4 Summary" title="Direct link to Lesson 4 Summary">​</a></h2>
<ul>
<li>
<p>You can mark a function as <code>payable</code> which will allow the function to accept Ether payments. Otherwise, the function will reject all transactions containing Ether.</p>
</li>
<li>
<p>The amount of ether sent to the contract can be viewed using <code>msg.value</code>.</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract OnlineStore {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	function buySomething() external payable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		// Check to make sure 0.001 ether was sent to the function call:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		require(msg.value == 0.001 ether);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		// If so, some logic to transfer the digital item to the caller of the function:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		transferThing(msg.sender);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>You can use <code>this.balance</code> to get the amount of ether available in the contract.</p>
</li>
<li>
<p>You can use the <code>transfer</code> function to send funds to any Ethereum address.</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract GetPaid is Ownable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	function withdraw() external onlyOwner {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		owner.transfer(this.balance);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>You can use <code>keccak256</code> for random number generation, but it is exploitable, so only use it in non-critical scenarios.</p>
</li>
<li>
<p>The rest of this lesson is about implementing specific game functionality in CryptoZombies and refactoring old code, which I wont go into here.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lesson-5-summary">Lesson 5 Summary<a href="#lesson-5-summary" class="hash-link" aria-label="Direct link to Lesson 5 Summary" title="Direct link to Lesson 5 Summary">​</a></h2>
<ul>
<li>
<p><a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-20.md" target="_blank" rel="noopener noreferrer">ERC20</a> tokens are great for representing alternative currencies within Ethereum.</p>
</li>
<li>
<p><a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-721.md" target="_blank" rel="noopener noreferrer">ERC721</a> tokens are good for representing collectables and other non-fungible assets.</p>
</li>
<li>
<p>Solidity contracts can inherit from multiple contracts like so:</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contract ZombieOwnership is ZombieAttack, ERC721 {...}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>You need to define the functions which make the token ERC721 compatible, and the logic may change depending on the specific implementation and functionality of your token. I will not go into these details.</p>
</li>
<li>
<p>You cannot have function modifiers with the same name.</p>
</li>
<li>
<p>You should use another <a href="https://github.com/OpenZeppelin/zeppelin-solidity/blob/master/contracts/math/SafeMath.sol" target="_blank" rel="noopener noreferrer">OpenZeppelin library called SafeMath</a> to prevent overflows and underflows which may lead to security vulnerabilities.</p>
</li>
<li>
<p>SafeMath uses the <code>assert</code> statement to make sure that the result of math functions are as we would suspect.</p>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">function add(uint256 a, uint256 b) internal pure returns (uint256) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	uint256 c = a + b;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	assert(c &gt;= a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	return c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><code>assert</code> is similar to <code>require</code> in that it will throw an error if false, however <code>assert</code> will not refund unused gas when a function fails.</p>
</li>
<li>
<p>You will need to define the SafeMath library for each different type of <code>uint</code> you use in your contract. As is, SafeMath will only work on <code>uint256</code>.</p>
</li>
<li>
<p>You can add comments to Solidity code using <code>//</code> or multi-line comments with <code>/* ... */</code>.</p>
</li>
<li>
<p>The standard way to format your comments among the Solidity community is the <a href="https://github.com/ethereum/wiki/wiki/Ethereum-Natural-Specification-Format" target="_blank" rel="noopener noreferrer">Ethereum Natural Specification Format</a>.</p>
</li>
</ul>
<h1>That&#x27;s all folks!</h1>
<p>Again, I strongly recommend that you follow the <a href="https://cryptozombies.io" target="_blank" rel="noopener noreferrer">CryptoZombies tutorial</a>. It is funny, comprehensive, and very informative. I talked about a lot of the Solidity specific knowledge that CryptoZombies teaches, but I leave out the most critical learning aspect: Designing and implementing a game using Solidity. This you can only learn by completing the full tutorial.</p>
<ul>
<li>Did this post help you?</li>
<li>Did I miss a critical piece of knowledge?</li>
<li>Did I make a mistake?</li>
</ul>
<p>Let me know, and as always, if you like what I do, you can send me a friendly thanks in the <a href="https://shawntabrizi.com/donate/" target="_blank" rel="noopener noreferrer">form of a donation</a> :)</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/blockchain/">blockchain</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/cryptozombies/">cryptozombies</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ethereum/">ethereum</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/programming/">programming</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/shawn-notes/">shawn notes</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/solidity/">solidity</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="This tutorial will show you how you can query the ETH balance of an Ethereum address across multiple Ethereum blocks, and visualize the results as a graph."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/ethereum/graphing-eth-balance-history-of-an-ethereum-address-using-parallel-asynchronous-requests-in-web3-js/">Graphing ETH Balance History of an Ethereum Address using Parallel Asynchronous Requests in Web3.js</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2018-03-12T06:31:35.000Z" itemprop="datePublished">March 12, 2018</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/shawntabrizi.png" alt="Shawn Tabrizi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shawn Tabrizi</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h5 class="anchor anchorWithStickyNavbar_LWe7" id="this-tutorial-will-show-you-how-you-can-query-the-eth-balance-of-an-ethereum-address-across-multiple-ethereum-blocks-and-visualize-the-results-as-a-graph">This tutorial will show you how you can query the ETH balance of an Ethereum address across multiple Ethereum blocks, and visualize the results as a graph.<a href="#this-tutorial-will-show-you-how-you-can-query-the-eth-balance-of-an-ethereum-address-across-multiple-ethereum-blocks-and-visualize-the-results-as-a-graph" class="hash-link" aria-label="Direct link to This tutorial will show you how you can query the ETH balance of an Ethereum address across multiple Ethereum blocks, and visualize the results as a graph." title="Direct link to This tutorial will show you how you can query the ETH balance of an Ethereum address across multiple Ethereum blocks, and visualize the results as a graph.">​</a></h5>
<p>Continuing my series of simple to consume <a href="https://shawntabrizi.com/ethereum/ethereum-web3-js-hello-world-get-eth-balance-ethereum-address/" target="_blank" rel="noopener noreferrer">Web3.js tutorials</a>, I want to now look into how we can start to visualize data from the Ethereum blockchain. In the past month or so, a bunch of ponzi scheme Ethereum contracts have been popping. The first notable one was POWHcoin which had the following brilliant whitepaper:</p>
<p><img loading="lazy" src="/assets/images/img_5acdcc67280aa-bc5e9998f4e067f88cc12d7cb58f38d9.png" width="579" height="461" class="img_ev3q"></p>
<p>This made me wonder what the actual graph of this Ethereum smart contract looked like...</p>
<p>Unfortunately, this smart contract eventually got hacked, so we won&#x27;t quite be able to see the peaks and valleys like the picture above shows, but we will be able to see the contract get completely liquidated, which may be interesting itself.</p>
<p>Let&#x27;s build it!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-ether-balance-at-a-certain-block">Getting the ether balance at a certain block<a href="#getting-the-ether-balance-at-a-certain-block" class="hash-link" aria-label="Direct link to Getting the ether balance at a certain block" title="Direct link to Getting the ether balance at a certain block">​</a></h2>
<p>The main thing we need to do here is get the ETH balance of an address at a specific block. This is actually quite easy by extending the call we make in my first tutorial:</p>
<p><a href="https://github.com/ethereum/wiki/wiki/JavaScript-API#web3ethgetbalance" target="_blank" rel="noopener noreferrer"><strong>web3.eth.getBalance</strong></a></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">web3.eth.getBalance(addressHexString [, defaultBlock] [, callback])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So if we simply pass a block number into this function, we should be able to get the balance at that point in time.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-the-first-transaction-for-an-ethereum-address">Getting the first transaction for an Ethereum address<a href="#getting-the-first-transaction-for-an-ethereum-address" class="hash-link" aria-label="Direct link to Getting the first transaction for an Ethereum address" title="Direct link to Getting the first transaction for an Ethereum address">​</a></h2>
<p>Before we create a loop getting the various balances, we need to know where to start looking. We could start at block 0, but we will get a ton of empty data before the address was ever used. Unfortunately, Web3.js does not have a good way to query the first transaction of an Ethereum address, so we will use Etherscan&#x27;s API to get that information. Note that if you want to do this entirely with Web3, you can, you will just need to create a smart searching algorithm, and look at a ton of blocks... probably not very efficient.</p>
<p><a href="https://etherscan.io/apis#accounts" target="_blank" rel="noopener noreferrer"><strong>Etherescan Developer APIs:</strong> Accounts</a></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://api.etherscan.io/api?module=account&amp;action=txlist&amp;address=0xA7CA36F7273D4d38fc2aEC5A454C497F86728a7A&amp;startblock=0&amp;page=1&amp;offset=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This query, which includes the POWHcoin address, will return the first transaction of that address, which is the contract creation. You can verify it is a contract creation call because the <code>to</code> value is empty, and the <code>contractAddress</code> is populated and matches the address we are observing.</p>
<p>Now we know to start looking at block 499258.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="get-the-current-block-number">Get the current block number<a href="#get-the-current-block-number" class="hash-link" aria-label="Direct link to Get the current block number" title="Direct link to Get the current block number">​</a></h2>
<p>Really the last piece of information we need is the current block number, so we know where to end our loop. This information is also available via Web3.js with the following call:</p>
<p><a href="https://github.com/ethereum/wiki/wiki/JavaScript-API#web3ethblocknumber" target="_blank" rel="noopener noreferrer"><strong>web3.eth.blockNumber</strong></a></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">web3.eth.getBlockNumber(callback(error, result){ ... })</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="so-lets-make-a-simple-loop">So let&#x27;s make a simple loop:<a href="#so-lets-make-a-simple-loop" class="hash-link" aria-label="Direct link to So let&#x27;s make a simple loop:" title="Direct link to So let&#x27;s make a simple loop:">​</a></h2>
<p>Here is a simple implementation of what we want to accomplish:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Check for MetaMask, otherwise use an HTTP Provider</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;load&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> web3 </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;undefined&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Web3 Detected! &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">currentProvider</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">constructor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">web3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Web3</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">currentProvider</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;No Web3 Detected... using HTTP Provider&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">web3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Web3</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Web3</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">providers</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">HttpProvider</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;https://mainnet.infura.io/&lt;APIKEY&gt;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Wrapper for Web3 callback</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">promisify</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">inner</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resolve</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> reject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">inner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">err</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">reject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Get the first transaction block for an address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getFirstBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">address</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;https://api.etherscan.io/api?module=account&amp;action=txlist&amp;address=&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> address </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&amp;startblock=0&amp;page=1&amp;offset=10&amp;sort=asc&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">blockNumber</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Given an address and a range of blocks, query the Ethereum blockchain for the ETH balance across the range</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getBalanceInRange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">address</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> startBlock</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> endBlock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Number of points to fetch between block range</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> pointCount </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Calculate the step size given the range of blocks and the number of points we want</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> step </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">endBlock </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> startBlock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> pointCount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Make sure step is at least 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">step </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        step </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Store the final result here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> balances </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Loop over the blocks, using the step value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> startBlock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> endBlock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> step</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Get the ETH value at that block</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> wei </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">promisify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">cb</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getBalance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> ether </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">fromWei</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">wei</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ether&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Add result to final output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        balances</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">block</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">balance</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ether</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> balances</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Main function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">graphBalance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Ethereum Address we want to look at</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> address </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0xA7CA36F7273D4d38fc2aEC5A454C497F86728a7A&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Find the intial range, from first block to current block</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> startBlock </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getFirstBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> endBlock </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">promisify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">cb</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getBlockNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> balances </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getBalanceInRange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> startBlock</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> endBlock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">balances</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">graphBalance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And the output we get is:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[{&quot;block&quot;:4990258,&quot;balance&quot;:0},{&quot;block&quot;:4995223,&quot;balance&quot;:690.3946401936848},{&quot;block&quot;:5000188,&quot;balance&quot;:812.2356284509416},{&quot;block&quot;:5005153,&quot;balance&quot;:1033.1702951440611},{&quot;block&quot;:5010118,&quot;balance&quot;:74.00248959231331},{&quot;block&quot;:5015083,&quot;balance&quot;:0.23714259262709267},{&quot;block&quot;:5020048,&quot;balance&quot;:0.000334978488623982},{&quot;block&quot;:5025013,&quot;balance&quot;:0.005036602641690202},{&quot;block&quot;:5029978,&quot;balance&quot;:0.005036602641690202},{&quot;block&quot;:5034943,&quot;balance&quot;:0.0526236993093083},{&quot;block&quot;:5039908,&quot;balance&quot;:0.04323124310148216},{&quot;block&quot;:5044873,&quot;balance&quot;:0.06245124310148216},{&quot;block&quot;:5049838,&quot;balance&quot;:0.06283124310148216},{&quot;block&quot;:5054803,&quot;balance&quot;:0.004397267827962452},{&quot;block&quot;:5059768,&quot;balance&quot;:0.004397267827962452},{&quot;block&quot;:5064733,&quot;balance&quot;:0.004397267827962452},{&quot;block&quot;:5069698,&quot;balance&quot;:0.03639726782796245},{&quot;block&quot;:5074663,&quot;balance&quot;:0.03639726782796245},{&quot;block&quot;:5079628,&quot;balance&quot;:0.03919726782796245},{&quot;block&quot;:5084593,&quot;balance&quot;:0.03919726782796245},{&quot;block&quot;:5089558,&quot;balance&quot;:0.04199726782796245},{&quot;block&quot;:5094523,&quot;balance&quot;:0.04205726782796245},{&quot;block&quot;:5099488,&quot;balance&quot;:0.04205726782796245},{&quot;block&quot;:5104453,&quot;balance&quot;:0.5869572678279624},{&quot;block&quot;:5109418,&quot;balance&quot;:0.000534060075850865},{&quot;block&quot;:5114383,&quot;balance&quot;:0.000534060075850865},{&quot;block&quot;:5119348,&quot;balance&quot;:0.000534060075850865},{&quot;block&quot;:5124313,&quot;balance&quot;:0.000534060075850865},{&quot;block&quot;:5129278,&quot;balance&quot;:0.000534060075850865},{&quot;block&quot;:5134243,&quot;balance&quot;:0.000534060075850865},{&quot;block&quot;:5139208,&quot;balance&quot;:0.02642294883092996},{&quot;block&quot;:5144173,&quot;balance&quot;:0.026442948830929958},{&quot;block&quot;:5149138,&quot;balance&quot;:0.026442948830929958},{&quot;block&quot;:5154103,&quot;balance&quot;:0.026442948830929958},{&quot;block&quot;:5159068,&quot;balance&quot;:0.03494294883092996},{&quot;block&quot;:5164033,&quot;balance&quot;:0.03993222727211795},{&quot;block&quot;:5168998,&quot;balance&quot;:0.04793222727211795},{&quot;block&quot;:5173963,&quot;balance&quot;:0.04793222727211795},{&quot;block&quot;:5178928,&quot;balance&quot;:0.04793222727211795},{&quot;block&quot;:5183893,&quot;balance&quot;:0.04793222727211795},{&quot;block&quot;:5188858,&quot;balance&quot;:0.04076568624207472},{&quot;block&quot;:5193823,&quot;balance&quot;:0.04076568624207472},{&quot;block&quot;:5198788,&quot;balance&quot;:0.04076568624207472},{&quot;block&quot;:5203753,&quot;balance&quot;:0.04076568624207472},{&quot;block&quot;:5208718,&quot;balance&quot;:0.04076568624207472},{&quot;block&quot;:5213683,&quot;balance&quot;:0.04076568624207472},{&quot;block&quot;:5218648,&quot;balance&quot;:0.04076568624207472},{&quot;block&quot;:5223613,&quot;balance&quot;:0.04076568624207472},{&quot;block&quot;:5228578,&quot;balance&quot;:0.04076568624207472},{&quot;block&quot;:5233543,&quot;balance&quot;:0.04076568624207472},{&quot;block&quot;:5238508,&quot;balance&quot;:0.04076568624207472}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Looks good so far! But if you run the code yourself, you will feel how dreadfully slow it is... That is because we are essentially doing a serial query, waiting around 100ms for every data-point:</p>
<p><img loading="lazy" src="/assets/images/img_5aa5b062b26a2-638e1b62aee3f7fd6a55462edd6b139c.png" width="901" height="700" class="img_ev3q"></p>
<p>But we can dramatically improve this by making the Web3.js requests asynchronous and in parallel!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="web3js-asynchronous-and-parallel-calls">Web3.js Asynchronous and Parallel Calls<a href="#web3js-asynchronous-and-parallel-calls" class="hash-link" aria-label="Direct link to Web3.js Asynchronous and Parallel Calls" title="Direct link to Web3.js Asynchronous and Parallel Calls">​</a></h2>
<p>We will need to update our <code>getBalanceInRange</code> function. Instead of <code>await</code>ing the balance data within each loop, we should simply queue up all of the requests, and then have them be processed at once with <code>Promise.all</code>.</p>
<p>So our new loop would look something like this:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Given an address and a range of blocks, query the Ethereum blockchain for the ETH balance across the range</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getBalanceInRange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">address</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> startBlock</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> endBlock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Number of points to fetch between block range</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> pointCount </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Calculate the step size given the range of blocks and the number of points we want</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> step </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">endBlock </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> startBlock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> pointCount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Make sure step is at least 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">step </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        step </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Queue the promises here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> promises </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Loop over the blocks, using the step value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> startBlock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> endBlock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> step</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Create a promise to query the ETH balance for that block</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> promise </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">promisify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">cb</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getBalance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Queue the promise and include data about the block for output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        promises</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">wei</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token literal-property property" style="color:#36acaa">block</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token literal-property property" style="color:#36acaa">balance</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseFloat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">fromWei</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">wei</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ether&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Resolve all promises in parellel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> balances </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">all</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">promises</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> balances</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Running this is MUCH faster, and the parallel nature of the calls can be seen in the network traces:</p>
<p><img loading="lazy" src="/assets/images/img_5aa5b09b0bb6f-fa68350f44c55601c39783ecda94408b.png" width="889" height="680" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="final-result">Final Result<a href="#final-result" class="hash-link" aria-label="Direct link to Final Result" title="Direct link to Final Result">​</a></h2>
<p>From there, you just need to pipe the data into your favorite JavaScript graph library, and you will get a view like this:</p>
<p><img loading="lazy" src="/assets/images/img_5aa5ad6c84572-e9ad611e1ce172128285a24f067dcdaf.png" width="871" height="443" class="img_ev3q"></p>
<p>Here you can see the quick rise of the ponzi scheme, the sell offs of &#x27;weak hands&#x27;, and finally the contract getting hacked and liquidating all the funds.</p>
<p>I will not go into detail about making this graph in this tutorial, but you can see my final app here:</p>
<p><a href="https://shawntabrizi.com/ethgraph/?address=0xA7CA36F7273D4d38fc2aEC5A454C497F86728a7A&amp;start=4990258&amp;end=5010862" target="_blank" rel="noopener noreferrer">https://shawntabrizi.com/ethgraph/?address=0xA7CA36F7273D4d38fc2aEC5A454C497F86728a7A&amp;start=4990258&amp;end=5010862</a></p>
<p>You can find the source code here:</p>
<p><a href="https://github.com/shawntabrizi/ETH-Balance-Graph" target="_blank" rel="noopener noreferrer">https://github.com/shawntabrizi/ETH-Balance-Graph</a></p>
<p>If you have any suggestions, or find any bugs please let me know! If you found this short tutorial helpful, feel free to send a donation using the information <a href="https://shawntabrizi.com/donate/" target="_blank" rel="noopener noreferrer">here</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ethereum/">ethereum</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/javascript/">javascript</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/web-3/">web3</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="The Azure Service Health team has been working hard to make it easy for you to set up custom service health alerts for your Azure resources. While we primarily focus on user experiences in the portal, we also know that there are many power users who are interested in doing these same actions in a programmatic way."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/code/set-azure-service-health-alerts-programmatically-using-powershell/">Set up Azure Service Health Alerts programmatically using PowerShell</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2018-01-11T07:03:59.000Z" itemprop="datePublished">January 11, 2018</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/shawntabrizi.png" alt="Shawn Tabrizi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shawn Tabrizi</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>The Azure Service Health team has been working hard to make it <a href="https://azure.microsoft.com/en-us/blog/get-notified-when-azure-service-incidents-impact-your-resources/" target="_blank" rel="noopener noreferrer">easy for you to set up custom service health alerts</a> for your Azure resources. While we primarily focus on user experiences in the portal, we also know that there are many power users who are interested in doing these same actions in a programmatic way.</p>
<p>This post will walk you through the steps required to programmatically create a service health alert using <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-authoring-templates" target="_blank" rel="noopener noreferrer">Azure Resource Manager templates</a> and <a href="https://docs.microsoft.com/en-us/powershell/azure/overview" target="_blank" rel="noopener noreferrer">Azure PowerShell</a>.</p>
<p>As described <a href="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-create-activity-log-alerts-with-resource-manager-template" target="_blank" rel="noopener noreferrer">here</a>, you can create any kind of activity log alert using this method (<a href="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-overview-activity-logs#categories-in-the-activity-log" target="_blank" rel="noopener noreferrer">Administrative, Autoscale, Recommendation, etc...</a>), however for the purposes of clarity, we will specifically focus on service health alerts.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting Started<a href="#getting-started" class="hash-link" aria-label="Direct link to Getting Started" title="Direct link to Getting Started">​</a></h2>
<p>Before you can follow this tutorial, you must have Azure PowerShell installed on your system. This will give you access to the <code>AzureRM</code> module, which is needed to interact with your Azure subscription.</p>
<p>You can follow the instructions <a href="https://docs.microsoft.com/en-us/powershell/azure/install-azurerm-ps" target="_blank" rel="noopener noreferrer">here to install Azure PowerShell</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-an-arm-template-for-service-health-alerts">Creating an ARM Template for Service Health Alerts<a href="#creating-an-arm-template-for-service-health-alerts" class="hash-link" aria-label="Direct link to Creating an ARM Template for Service Health Alerts" title="Direct link to Creating an ARM Template for Service Health Alerts">​</a></h2>
<p>A service health alert is represented by JSON which is stored in your Azure subscription, and follows rules defined by Azure&#x27;s internal system. This JSON is also referred to as the Azure Resource Manager template. You can find an example of a general Activity Log Alert template <a href="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-create-activity-log-alerts-with-resource-manager-template" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>For service health alerts, we should use a template like this:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;$schema&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;contentVersion&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.0.0.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;parameters&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;activityLogAlertName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;metadata&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Unique name (within the Resource Group) for the Activity log alert.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;activityLogAlertEnabled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bool&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;defaultValue&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;metadata&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Indicates whether or not the alert is enabled.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;actionGroupResourceId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;metadata&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Resource Id for the Action group.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;resources&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Microsoft.Insights/activityLogAlerts&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;apiVersion&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2017-04-01&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[parameters(&#x27;activityLogAlertName&#x27;)]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;location&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Global&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;kind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;tags&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;enabled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[parameters(&#x27;activityLogAlertEnabled&#x27;)]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;scopes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;[subscription().id]&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;condition&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string-property property" style="color:#36acaa">&quot;allOf&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token string-property property" style="color:#36acaa">&quot;field&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;category&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token string-property property" style="color:#36acaa">&quot;equals&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ServiceHealth&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token string-property property" style="color:#36acaa">&quot;containsAny&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;actions&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string-property property" style="color:#36acaa">&quot;actionGroups&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token string-property property" style="color:#36acaa">&quot;actionGroupId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[parameters(&#x27;actionGroupResourceId&#x27;)]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token string-property property" style="color:#36acaa">&quot;webhookProperties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should save this file as <code>servicehealthalert.json</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="a-quick-note-on-generating-custom-arm-templates">A quick note on generating custom ARM templates<a href="#a-quick-note-on-generating-custom-arm-templates" class="hash-link" aria-label="Direct link to A quick note on generating custom ARM templates" title="Direct link to A quick note on generating custom ARM templates">​</a></h4>
<p>I would assume that most of you reading this post do not want or need to start from scratch. Instead, you know what you want to achieve using the Azure portal UX, and you simply want to automate that process. In that case, there is an easy way for you to generate a custom ARM template for your needs:</p>
<ol>
<li>Go to the <a href="https://portal.azure.com/#blade/Microsoft_Azure_Health/AzureHealthBrowseBlade/healthalerts" target="_blank" rel="noopener noreferrer">Health Alerts</a> section in Azure Service Health</li>
<li>Create a <a href="https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-activity-log-alerts-on-service-notifications?toc=%2fazure%2fservice-health%2ftoc.json" target="_blank" rel="noopener noreferrer">new service health alert</a></li>
<li>Take note of the resource group you save the alert in</li>
<li>Then go to the <a href="https://resources.azure.com/" target="_blank" rel="noopener noreferrer">Azure Resource Explorer</a></li>
<li>Navigate to: subscriptions &gt; (subscription) &gt; resourceGroups &gt; (resourceGroup) &gt; providers &gt; microsoft.insights &gt; activityLogAlerts &gt; (alertName)</li>
<li>You will find a JSON representation of your alert with all your custom conditions</li>
<li>Copy those extra conditions into the template above</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples-of-custom-conditions">Examples of Custom Conditions<a href="#examples-of-custom-conditions" class="hash-link" aria-label="Direct link to Examples of Custom Conditions" title="Direct link to Examples of Custom Conditions">​</a></h2>
<p>The template provided above is a very broad service health alert that will be triggered whenever any activity log with the category <code>ServiceHealth</code> is created. However, using this same JSON template, you can further specify what kinds of events you want to be alerted for:</p>
<ul>
<li>Only be notified for certain Azure services</li>
<li>Only be notified for certain regions</li>
<li>Only be notified for certain health alert types</li>
</ul>
<p>Note that there are over 122 Azure services, across more than 28 regions, so your JSON can start to get a little messy if you try to hand type it all out. I recommend you follow the instructions above on generating custom ARM templates.</p>
<p>Here is an example of an ARM template that takes advantage of all 3 of these conditions:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string-property property" style="color:#36acaa">&quot;$schema&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string-property property" style="color:#36acaa">&quot;contentVersion&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;1.0.0.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string-property property" style="color:#36acaa">&quot;parameters&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;activityLogAlertName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;metadata&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Unique name (within the Resource Group) for the Activity log alert.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;activityLogAlertEnabled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;bool&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;defaultValue&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;metadata&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Indicates whether or not the alert is enabled.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;actionGroupResourceId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;metadata&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Resource Id for the Action group.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string-property property" style="color:#36acaa">&quot;resources&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Microsoft.Insights/activityLogAlerts&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;apiVersion&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;2017-04-01&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;[parameters(&#x27;activityLogAlertName&#x27;)]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;location&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Global&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;kind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;tags&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token string-property property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;enabled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;[parameters(&#x27;activityLogAlertEnabled&#x27;)]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;scopes&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">&quot;[subscription().id]&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;condition&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string-property property" style="color:#36acaa">&quot;allOf&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;field&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;category&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;equals&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ServiceHealth&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;containsAny&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;field&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;properties.incidentType&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;equals&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Informational&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;containsAny&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;field&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;properties.incidentType&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;equals&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ActionRequired&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;containsAny&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;field&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;properties.impactedServices[?(@.ServiceName == &#x27;Advisor&#x27; || @.ServiceName == &#x27;Alerts &amp; Metrics&#x27; || @.ServiceName == &#x27;App Service&#x27;)].ImpactedRegions[*].RegionName&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;equals&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;containsAny&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;Australia East&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;Brazil South&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;Canada East&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;Central US&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">&quot;actions&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string-property property" style="color:#36acaa">&quot;actionGroups&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;actionGroupId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;[parameters(&#x27;actionGroupResourceId&#x27;)]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token string-property property" style="color:#36acaa">&quot;webhookProperties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The ARM template is actually pretty powerful in terms of the logic that it can resolve. You are not limited to only these 3 options when customizing the alert. You can pretty much add logic to any attribute which exists in the activity log. However, if you customize the JSON template too much, you might break the UX in the Azure portal. This is not a big deal, but can cause problems loading the alert in the portal, and if you do ever update the alert in the portal, you will likely lose all of your custom logic.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-new-alert-using-powershell">Creating a new alert using PowerShell<a href="#creating-a-new-alert-using-powershell" class="hash-link" aria-label="Direct link to Creating a new alert using PowerShell" title="Direct link to Creating a new alert using PowerShell">​</a></h2>
<p>Now that you have your ARM template created, creating a new activity log alert in your subscription is relatively easy. Using the <code>AzureRM</code> module, run the following:</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Login-AzureRmAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Select-AzureRmSubscription -SubscriptionName &lt;subscription_name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New-AzureRmResourceGroupDeployment -Name ExampleDeployment -ResourceGroupName &lt;resource_group&gt; -TemplateFile &lt;path:\to\servicehealthalert.json&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should then be prompted to type in the Alert Name and the Action Group Resource ID:</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Supply values for the following parameters:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(Type !? for Help.)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">activityLogAlertName: &lt;Alert Name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">actionGroupResourceId: /subscriptions/&lt;subscriptionId&gt;/resourceGroups/&lt;resouceGroup&gt;/providers/microsoft.insights/actionGroups/&lt;actionGroup&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If there are no errors, you should get the following confirmation in PowerShell:</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DeploymentName          : ExampleDeployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ResourceGroupName       : &lt;resourceGroup&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProvisioningState       : Succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Timestamp               : 11/8/2017 2:32:00 AM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mode                    : Incremental</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TemplateLink            :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parameters              :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          Name                     Type       Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          ===============          =========  ==========</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          activityLogAlertName     String     &lt;Alert Name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          activityLogAlertEnabled  Bool       True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          actionGroupResourceId    String     /subscriptions/&lt;subscriptionId&gt;/resourceGroups/&lt;resouceGroup&gt;/providers/microsoft.insights/actionGroups/&lt;actionGroup&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Outputs                 :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DeploymentDebugLogLevel :</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And that is it! You can now stay fully informed when Azure service issues affect you.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/arm/">arm</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/azure-resource-manager/">azure resource manager</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/azure-service-health/">azure service health</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/health-alert/">health alert</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/powershell/">powershell</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="When I was building ethfolio, I had to figure out how to retrieve the token information for multiple Ethereum addresses. To get this information, you have to query an API per address that you want to retrieve."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/code/programmatically-fetch-multiple-apis-parallel-using-async-await-javascript/">Programmatically fetch multiple APIs in parallel using async and await in JavaScript</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2017-12-09T11:13:44.000Z" itemprop="datePublished">December 9, 2017</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/shawntabrizi.png" alt="Shawn Tabrizi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shawn Tabrizi</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>When I was building <a href="https://shawntabrizi.com/ethfolio/" target="_blank" rel="noopener noreferrer">ethfolio</a>, I had to figure out how to retrieve the token information for multiple Ethereum addresses. To get this information, you have to query an API per address that you want to retrieve.</p>
<p>Ideally, all of these calls would happen Asynchronously and in parallel, to give the  best and fastest experience to the user. However, how exactly to do this is not so obvious (to me at least).</p>
<p>Let&#x27;s assume that you have an array of URLs that you want to fetch at the same time. You can use an asynchronous function like this to easily retrieve all the data in the best way possible:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getAllUrls</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">urls</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">all</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            urls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token parameter">url</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This function will return an array of &#x27;responses&#x27; which you can then use for the rest of your program. Calling the function is simple too!</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> responses </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getAllUrls</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">urls</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ultimately the trick here is that a <code>Promise</code> gets executed as soon as it gets created. The <code>map</code> function will create all the <code>fetch</code> promises and they will immediately start to execute. Then, we wait for all the promises to complete using the <code>Promise.all</code> function.</p>
<p>I tried other ways to construct this kind of function, but none were quite as simple or effective as this. I hope you find this helpful :)</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/async/">async</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/fetch/">fetch</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/javascript/">javascript</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="A common question that I have for others investing in cryptocurrencies is: &quot;What coins are you invested in?&quot;"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/ethereum/ethfolio-client-side-app-show-ethereum-token-distribution/">ethfolio: A client side app to show your Ethereum token distribution</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2017-12-04T15:54:33.000Z" itemprop="datePublished">December 4, 2017</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/shawntabrizi.png" alt="Shawn Tabrizi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shawn Tabrizi</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>A common question that I have for others investing in cryptocurrencies is: <em>&quot;What coins are you invested in?&quot;</em></p>
<p>It is surprisingly hard to distinguish fear, uncertainty, doubt (FUD), fear of missing out (FOMO), and solid informed advice apart from one another. But as the saying goes:</p>
<blockquote>
<p>Put your money where your mouth is.</p>
</blockquote>
<p>This is the goal of ethfolio:</p>
<ul>
<li>Allow users to easily import the coins they currently are holding</li>
<li>Allow users to share this token distribution</li>
<li>And do so safely without needing to expose their Ethereum addresses or total value of their holdings</li>
</ul>
<p>This actually seemed very straightforward, so I decided to tackle the project. Rather than go through all the work to actually query the blockchain as I have been learning to do in my other posts, I decided to just use an API which consolidates all this information.</p>
<p><a href="https://ethplorer.io/" target="_blank" rel="noopener noreferrer">Ethplorer.io</a> was perfect for this. They have a <code>/getAddressInfo/</code> <a href="https://github.com/EverexIO/Ethplorer/wiki/Ethplorer-API?from=etop" target="_blank" rel="noopener noreferrer">api endpoint</a> which provides details about the tokens at an Ethereum address, and even details about those tokens like the price in USD.</p>
<p>This was perfect! So I begin to envision the user story:</p>
<ol>
<li>User goes to ethfolio, types in one or more Ethereum addresses</li>
<li>User presses a &quot;submit&quot; button</li>
<li>In the background we query the Ethplorer API to get all the tokens across all the addresses, and their current price in USD</li>
<li>We then add up total amount of each token the user has across their wallets</li>
<li>Then, we use the price information, to calculate the relative USD price of each token balance</li>
<li>Then we calculate the total USD price across all balances, to find the percentage a particular token represents in the overall portfolio</li>
<li>Display the results</li>
</ol>
<p>Following this process, the user can then share details about their token distribution without ever needing to share details about their specific addresses (which is important for anonymity) and without needing to share details about the total balance they hold (which could be sensitive to the user.)</p>
<p>With these steps in mind, I spent a day and created this pretty quickly:</p>
<p><a href="https://shawntabrizi.com/ethfolio/" target="_blank" rel="noopener noreferrer">https://shawntabrizi.com/ethfolio/</a></p>
<p><img loading="lazy" src="/assets/images/img_5a24f8f17ea4a-1137adf635f48a4d312122bbf1d000d9.png" width="829" height="688" class="img_ev3q"></p>
<p>You may notice that there are some options to &quot;Store total USD value&quot; and &quot;Store all addresses&quot;. Lets talk about what I tried to do with &quot;Save &amp; Share&quot;.</p>
<p>I wanted this to be a completely client side application. This means I don&#x27;t have to do any server stuff,  the user can better trust the application (because they can see all the code), and calling the API would come from each user, so I wouldn&#x27;t get throttled if the site takes off. My question then was: &quot;How can I create a database for a client side application?&quot;</p>
<p>This means that writing and reading from the database needs to be in such a way that it won&#x27;t compromise the data being stored. My first thought was to try and use Google Forms/Sheets. Google Forms is a method for publicly entering data, which can get stored into a Google Sheet which can be publicly viewed. Using Google&#x27;s authorization layer, I could make it so that users could not edit the sheet, only add data to it, and read from it.</p>
<p>I got the part of the app to write to Google working. It doesn&#x27;t look pretty because the app gives a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS" target="_blank" rel="noopener noreferrer">CORS error</a>, but Google seems to accept the data anyway.</p>
<p><strong>Ignore the error</strong></p>
<p><img loading="lazy" src="/assets/images/img_5a24fdb9c8555-654c6d76803e09d25bb4e7c943ef8954.png" width="495" height="553" class="img_ev3q"></p>
<p><strong>Cause data gets saved anyway...</strong></p>
<p><img loading="lazy" src="/assets/images/img_5a24fd98c904a-e863b7dfa9fc0a903d9bccd759975c53.png" width="648" height="221" class="img_ev3q"></p>
<p>However, I was not able to ever retrieve this data! Even though this sheet is public, it seems like to call any of Google&#x27;s APIs you must be authenticated, at least with an API key.</p>
<p>I created an API key, but trying to use it I get this error:</p>
<p><img loading="lazy" src="data:image/png;base64,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" width="712" height="284" class="img_ev3q"></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;message&quot;: &quot;API Key not found. Please pass a valid API key.&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Every API key is associated with a &quot;Google App Project&quot;, and I needed to specifically enable the Google Sheets API for the project where I was creating the API key.</p>
<p><img loading="lazy" src="/assets/images/img_5a2505a15b129-60d10a78cb4c870bace797337e37d36e.png" width="692" height="382" class="img_ev3q"></p>
<p>Now that this call works, I just need to build an interface to read from the sheet, and re-display the data! That will be coming up next!</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/cryptocurrency/">cryptocurrency</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ethereum/">ethereum</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/javascript/">javascript</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="One of the things I learned when writing my &quot;Hello World&quot; tutorial for Ethereum and Web3.js was the importance of having your functions which call the blockchain run asynchronously. Without this, we would be unable to support users who use MetaMask as their Ethereum provider, and probably even more important, we may bring bad user experiences by locking up the browser during long HTTP requests. From the MetaMask developer FAQ:"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/ethereum/making-web3-js-work-asynchronously-javascript-promises-await/">Making Web3.js work asynchronously with JavaScript Promises and await</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2017-11-24T08:47:40.000Z" itemprop="datePublished">November 24, 2017</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/shawntabrizi.png" alt="Shawn Tabrizi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shawn Tabrizi</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>One of the things I learned when writing my <a href="https://shawntabrizi.com/ethereum/correcting-ethereum-web3-js-hello-world/" target="_blank" rel="noopener noreferrer">&quot;Hello World&quot; tutorial for Ethereum and Web3.js</a> was the importance of having your functions which call the blockchain run asynchronously. Without this, we would be unable to support users who use MetaMask as their Ethereum provider, and probably even more important, we may bring bad user experiences by locking up the browser during long HTTP requests. From the MetaMask developer FAQ:</p>
<blockquote>
<p>Using synchronous calls is both a technical limitation and a user experience issue. They block the user&#x27;s interface. So using them is a bad practice, anyway. Think of this API restriction as a gift to your users.</p>
</blockquote>
<p>Setting up a Web3 function to work asynchronously was pretty easy to figure out for a single call; but what about making multiple calls through Web3, that all need to be asynchronous, but also have dependencies on one another?</p>
<p>An example would be calculating the ERC-20 token balance of an Ethereum address. To do this, you need to know both the balance of tokens at the address, but also the decimals value for that token to convert to the right units. JavaScript Promises are the natural solution here. They allow you to track the status of an asynchronous function, and perform actions after your multiple dependencies all resolve.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="turning-web3js-functions-into-javascript-promises">Turning Web3.js functions into JavaScript Promises<a href="#turning-web3js-functions-into-javascript-promises" class="hash-link" aria-label="Direct link to Turning Web3.js functions into JavaScript Promises" title="Direct link to Turning Web3.js functions into JavaScript Promises">​</a></h2>
<p>In my <a href="https://shawntabrizi.com/ethereum/correcting-ethereum-web3-js-hello-world/" target="_blank" rel="noopener noreferrer">&quot;Hello World&quot; tutorial</a>, I show you can make an asynchronous requests by adding an error first callback to the Web3.js functions:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getBalance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As I mentioned, if we depend on multiple calls from the Ethereum blockchain to create a result, using <a href="https://developers.google.com/web/fundamentals/primers/promises" target="_blank" rel="noopener noreferrer">JavaScript Promises</a> is a good solution. They allow you to react to a success or a failure from an asynchronous function. Creating a promise from the error first callback function is pretty straightforward:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getBalance</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">address</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resolve</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> reject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getBalance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">reject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>But we can actually make this process even simpler for multiple Web3 functions by creating a wrapper which both makes the function asynchronous, and turn it into a promise; basically automating what we would repeat above for each different Web3 function we call.</p>
<p>Here is the wrapper from <a href="https://ethereum.stackexchange.com/a/24238/19577" target="_blank" rel="noopener noreferrer">0xcaff posted in StackExchange</a>:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">promisify</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">inner</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Promise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">resolve</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> reject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">inner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">err</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">reject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now that we have a Promise, we can take advantage of the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank" rel="noopener noreferrer">async/await pattern</a> which simplifies not only the look, but also the behavior of Promises.</p>
<p>Putting this all together, let&#x27;s show how simple this makes getting the token balance for an ETH account. We convert our original &quot;Hello World&quot; <code>getBalance</code> into an asynchronous function, like so:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getBalance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> wei</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> balance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;address&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wei </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">promisify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">cb</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getBalance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        balance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> web3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">fromWei</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> wei</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ether&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;output&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">innerHTML</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> balance </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; ETH&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getElementById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;output&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">innerHTML</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Not much shorter for a single function, but will certainly make things better the more separate functions we call. My next post will show the results of these smaller educational posts, and how we can put it together to create the project I have been hinting above: <a href="https://github.com/shawntabrizi/ERC20-Token-Balance" target="_blank" rel="noopener noreferrer">Getting the ERC-20 balance of an Ethereum Address</a>.</p>
<p>I hope this teaches you something! Again, this may be trivial to many, but was not so straightforward when I first started to tackling these problems. If it did help you, feel free to support me with a <a href="https://shawntabrizi.com/donate/" target="_blank" rel="noopener noreferrer">small donation.</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/async/">async</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/javascript/">javascript</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/promises/">promises</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/web-3/">web3</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="This post will introduce you to Token Contract ABIs in Ethereum, and show you how you can use a the Human Standard Token ABI to access the token balances of ERC-20 compatible tokens."><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/ethereum/ethereum-token-contract-abi-web3-erc-20-human-standard-tokens/">Ethereum Token Contract ABI in Web3.js for ERC-20 and Human Standard Tokens</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2017-11-08T16:13:19.000Z" itemprop="datePublished">November 8, 2017</time> · <!-- -->7 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/shawntabrizi.png" alt="Shawn Tabrizi" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/shawntabrizi" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shawn Tabrizi</span></a></div><small class="avatar__subtitle" itemprop="description">Software Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h5 class="anchor anchorWithStickyNavbar_LWe7" id="this-post-will-introduce-you-to-token-contract-abis-in-ethereum-and-show-you-how-you-can-use-a-the-human-standard-token-abi-to-access-the-token-balances-of-erc-20-compatible-tokens">This post will introduce you to Token Contract ABIs in Ethereum, and show you how you can use a the <a href="https://github.com/shawntabrizi/ERC-20-Token-Balance/blob/master/human_standard_token_abi.js" target="_blank" rel="noopener noreferrer">Human Standard Token ABI</a> to access the token balances of ERC-20 compatible tokens.<a href="#this-post-will-introduce-you-to-token-contract-abis-in-ethereum-and-show-you-how-you-can-use-a-the-human-standard-token-abi-to-access-the-token-balances-of-erc-20-compatible-tokens" class="hash-link" aria-label="Direct link to this-post-will-introduce-you-to-token-contract-abis-in-ethereum-and-show-you-how-you-can-use-a-the-human-standard-token-abi-to-access-the-token-balances-of-erc-20-compatible-tokens" title="Direct link to this-post-will-introduce-you-to-token-contract-abis-in-ethereum-and-show-you-how-you-can-use-a-the-human-standard-token-abi-to-access-the-token-balances-of-erc-20-compatible-tokens">​</a></h5>
<p>Let me start by saying that this post may be trivial to some, but was very confusing to me, a brand new user to the Ethereum and Web3.js development world. After writing my <a href="https://shawntabrizi.com/ethereum/ethereum-web3-js-hello-world-get-eth-balance-ethereum-address/" target="_blank" rel="noopener noreferrer">&quot;Hello World&quot; project</a> which gets the ETH balance for an Ethereum Address in Web3, I began to think about the next small step I can take and teach to others. Naturally, I thought it would make sense to do a similar project, but instead, get the Token Balance for ERC-20 tokens at an Ethereum Address.</p>
<p>With Web3.js, you can easily find the template for this functionality:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> tokenContract </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> eth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">contract</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tokenABI</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">at</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tokenAddress</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> tokenBalance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tokenContract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">balanceOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ethereumAddress</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Seems easy enough to get the <a href="https://etherscan.io/tokens" target="_blank" rel="noopener noreferrer">Token Address</a>, but what is this <code>tokenABI</code> value that we need to use?</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-simplified-explanation-of-a-token-contract-abi">A simplified explanation of a token contract ABI<a href="#a-simplified-explanation-of-a-token-contract-abi" class="hash-link" aria-label="Direct link to A simplified explanation of a token contract ABI" title="Direct link to A simplified explanation of a token contract ABI">​</a></h2>
<p>A little bit of searching will give you documents that teach you about the Application Binary Interface (ABI) <a href="https://solidity.readthedocs.io/en/develop/abi-spec.html" target="_blank" rel="noopener noreferrer">like this</a>, but no real layman&#x27;s terms explanation. Here is my attempt at one:</p>
<blockquote>
<p>In Ethereum, the Application Binary Interface (ABI) is a predefined template of the functions a contract exposes.</p>
</blockquote>
<p>You know when you import a new library into an IDE, you automatically get all that nice autocomplete and Intellisense? You type the library name, add &quot;<code>.</code>&quot; and a list of functions appears in front of you:</p>
<p><img loading="lazy" src="/assets/images/img_5a02bedd6be8c-b894149a64ce6de6a81e147f903d432e.png" width="742" height="267" class="img_ev3q"></p>
<p>Imagine if instead, you needed to know ahead of time the functions the library exposes, and then define them for the IDE so that the autocomplete would work... that is pretty much what is happening here.</p>
<p>An Ethereum Contract ABI will define the different functions that a contract exposes, and each function definition will contain things like the function type, name, inputs, outputs, <a href="https://solidity.readthedocs.io/en/develop/abi-spec.html#json" target="_blank" rel="noopener noreferrer">and more</a>. It even contains information like whether the contract accepts payments in ether or not. Here is the JSON ABI of the <code>balanceOf()</code> function we ultimately want to use:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;constant&quot;: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;inputs&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;name&quot;: &quot;_owner&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;address&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;name&quot;: &quot;balanceOf&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;outputs&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;name&quot;: &quot;balance&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;uint256&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;payable&quot;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;type&quot;: &quot;function&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>I think this is easy enough to read: It is a <code>function</code> which accepts an <code>address</code> as an input, and outputs a <code>balance</code> as an unsigned int. <strong>But is this enough to start talking to an Ethereum contract? What about all the other functions that contract might have? How will I find the full contract ABI for each contract I want to talk to?</strong></p>
<p>Here are the things I learned when trying to answer these questions:</p>
<ul>
<li>You do NOT need the full ABI to interact with a Token Contract. You only need to define the functions which you want to use.</li>
<li>You cannot programmatically generate the ABI for a given contract using data from the Ethereum blockchain. In order to generate the full contract ABI from scratch, you will need the full contract source code, before it is compiled. Note that only the compiled code exists at a contract address.</li>
<li>Some contracts have functions which are intentionally &#x27;hidden&#x27; from the public, and they do not intend the public to use.</li>
</ul>
<p>Therefore, there really is no way to dynamically call any contract address. If only there were some standard set of functions shared across all contracts...</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-erc-20-and-human-standard-token">The ERC-20 and Human Standard Token<a href="#the-erc-20-and-human-standard-token" class="hash-link" aria-label="Direct link to The ERC-20 and Human Standard Token" title="Direct link to The ERC-20 and Human Standard Token">​</a></h2>
<p>From <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-20-token-standard.md" target="_blank" rel="noopener noreferrer">the specification</a>:</p>
<blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="simple-summary">Simple Summary<a href="#simple-summary" class="hash-link" aria-label="Direct link to Simple Summary" title="Direct link to Simple Summary">​</a></h2>
<p>A standard interface for tokens.</p>
</blockquote>
<p>The value of ERC-20 tokens is that they all have a standard set of functions which allow you to interact with each of them in the exact same way. This is why there is so much hype around new Ethereum application which use ERC-20 tokens: there is nearly zero effort to add these tokens to existing platforms like Cryptocurrency Exchanges which means smoother adoption, easier to sell/track, and of course more hype ($$$).</p>
<p>What does it take to be ERC-20 compliant?</p>
<p>Not much really. You just need to expose the non-optional methods and events described <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-20-token-standard.md" target="_blank" rel="noopener noreferrer">here</a>. Beyond the core ERC-20 standard, there are also standard optional parameters which are intended for humans. See <a href="https://github.com/ConsenSys/Tokens" target="_blank" rel="noopener noreferrer">here</a>:</p>
<blockquote>
<p>In other words. This is intended for deployment in something like a Token Factory or Mist wallet, and then used by humans. Imagine coins, currencies, shares, voting weight, etc. Machine-based, rapid creation of many tokens would not necessarily need these extra features or will be minted in other manners.</p>
<ol>
<li>Initial Finite Supply (upon creation one specifies how much is minted). 2) In the absence of a token registry: Optional Decimal, Symbol &amp; Name. 3) Optional approveAndCall() functionality to notify a contract if an approval() has occurred.</li>
</ol>
</blockquote>
<p>This is the &quot;Human Standard Token&quot;, which of course is a super-set of the ERC-20 standard. Additionally, many tokens have a <code>version()</code> function which is also available in the ABI provided below.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="so-lets-get-it-working">So let&#x27;s get it working!<a href="#so-lets-get-it-working" class="hash-link" aria-label="Direct link to So let&#x27;s get it working!" title="Direct link to So let&#x27;s get it working!">​</a></h2>
<p>Now that you have sufficient background to understand what is going on, lets actually go and make some calls to ERC-20 token contracts.</p>
<p>To start, you can find the Human Standard Token ABI <a href="https://github.com/shawntabrizi/ERC-20-Token-Balance/blob/master/human_standard_token_abi.js" target="_blank" rel="noopener noreferrer">here on GitHub</a>. The JS file simply puts the ABI JSON object into a varaible called <code>human_standard_token_abi</code> which allows you to really easily use it in a project.</p>
<p>The most basic project that can take advantage of these things would look something like this:</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">charset</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">UTF-8</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text/javascript</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">./web3.min.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text/javascript</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">./human_standard_token_abi.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> web3 </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">new</span><span class="token script language-javascript"> </span><span class="token script language-javascript class-name">Web3</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript keyword" style="color:#00009f">new</span><span class="token script language-javascript"> </span><span class="token script language-javascript class-name">Web3</span><span class="token script language-javascript class-name punctuation" style="color:#393A34">.</span><span class="token script language-javascript class-name">providers</span><span class="token script language-javascript class-name punctuation" style="color:#393A34">.</span><span class="token script language-javascript class-name">HttpProvider</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;https://mainnet.infura.io/&lt;APIKEY&gt;&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    address </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&quot;0x0e2e75240c69495d2b9e768b548db381de2142b9&quot;</span><span class="token script language-javascript"> </span><span class="token script language-javascript comment" style="color:#999988;font-style:italic">//From Etherscan</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    contractAddress </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&quot;0xd26114cd6EE289AccF82350c8d8487fedB8A0C07&quot;</span><span class="token script language-javascript"> </span><span class="token script language-javascript comment" style="color:#999988;font-style:italic">//OMG</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    contractABI </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> human_standard_token_abi</span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    tokenContract </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> web3</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">eth</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">contract</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">contractABI</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">at</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">contractAddress</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript console class-name">console</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">log</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">tokenContract</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">balanceOf</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">address</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">toNumber</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Check the console (F12)</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And the output:</p>
<p><img loading="lazy" src="/assets/images/img_5a02b864c00dc-1f5a7e963a1bade40525eac26c19c086.png" width="718" height="289" class="img_ev3q"></p>
<p>Take a look at an implementation of this sample <a href="https://shawntabrizi.com/ERC20-Token-Balance/" target="_blank" rel="noopener noreferrer">here</a>. You can find the source code for this on <a href="https://github.com/shawntabrizi/ERC20-Token-Balance" target="_blank" rel="noopener noreferrer">GitHub</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-if">What if...<a href="#what-if" class="hash-link" aria-label="Direct link to What if..." title="Direct link to What if...">​</a></h2>
<p>Let&#x27;s try a few fringe scenarios with this contract ABI. We will be testing this against <a href="https://etherscan.io/token/OmiseGo?a=0x0e2e75240c69495d2b9e768b548db381de2142b9#readContract" target="_blank" rel="noopener noreferrer">OmiseGo</a>.</p>
<ul>
<li>What if we call a contract with a function we defined, but does not exist on the contract?</li>
</ul>
<p>OMG does not have a <code>version()</code> function, but we define it by default in our <code>human_standard_token_abi</code>. So let&#x27;s call it:</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tokenContract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">version</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>&quot;Uncaught Error: new BigNumber() not a base 16 number&quot;</p>
</blockquote>
<p><img loading="lazy" src="/assets/images/img_5a02ba10afdf7-cf12a177e9ae6bf5885b4d2edb15bd86.png" width="405" height="310" class="img_ev3q"></p>
<ul>
<li>What if we call a contract with a function that exists, but we did not define in the ABI?</li>
</ul>
<p>OMG has the function <code>mintingFinished()</code> which is not part of the Human Standard Token ABI. If we call it, we get the following error:</p>
<blockquote>
<p>&quot;Uncaught TypeError: tokenContract.mintingFinished is not a function&quot;</p>
</blockquote>
<p><img loading="lazy" src="data:image/png;base64,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" width="406" height="127" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-i-hope-you-learned">What I hope you learned:<a href="#what-i-hope-you-learned" class="hash-link" aria-label="Direct link to What I hope you learned:" title="Direct link to What I hope you learned:">​</a></h2>
<ul>
<li>The requirements to call an ERC-20 compliant token contract using Web3.js</li>
<li>What a Token Contract ABI is on the Ethereum Blockchain</li>
<li>Why the ERC-20 standard is pretty great for develeopers</li>
<li>How to easily add the <code>human_standard_token_abi</code> to your JavaScript web application</li>
</ul>
<p>Keep an eye out for <a href="https://shawntabrizi.com/ethereum/making-web3-js-work-asynchronously-javascript-promises-await/" target="_blank" rel="noopener noreferrer">my next post</a>, which will detail how to set up Web3.js for JavaScript promises, so we can execute multiple Web3 functions asynchronously.</p>
<p>If you liked this post, and want to support me, feel free to <a href="https://shawntabrizi.com/donate/" target="_blank" rel="noopener noreferrer">send me a donation.</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/application-binary-interface/">application binary interface</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/blockchain/">blockchain</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/erc-20/">erc20</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/ethereum/">ethereum</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/human-standard-token/">human standard token</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/javascript/">javascript</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/token/">token</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/web-3/">web3</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/page/2/"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/page/4/"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="text--center"><a href="https://github.com/shawntabrizi/" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-inverse fa-3x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" style="transform-origin:0.484375em 0.5em"><g transform="translate(248 256)"><g transform="translate(0, 0)  scale(0.625, 0.625)  rotate(0 0 0)"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" transform="translate(-248 -256)"></path></g></g></svg></a><a href="https://www.linkedin.com/in/shawn-tabrizi/" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin fa-inverse fa-3x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="transform-origin:0.4375em 0.5em"><g transform="translate(224 256)"><g transform="translate(0, 0)  scale(0.625, 0.625)  rotate(0 0 0)"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z" transform="translate(-224 -256)"></path></g></g></svg></a><a href="https://twitter.com/shawntabrizi" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter fa-inverse fa-3x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="transform-origin:0.5em 0.5em"><g transform="translate(256 256)"><g transform="translate(0, 0)  scale(0.625, 0.625)  rotate(0 0 0)"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" transform="translate(-256 -256)"></path></g></g></svg></a><a href="https://stackexchange.com/users/1489538" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="stack-exchange" class="svg-inline--fa fa-stack-exchange fa-inverse fa-3x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="transform-origin:0.4375em 0.5em"><g transform="translate(224 256)"><g transform="translate(0, 0)  scale(0.625, 0.625)  rotate(0 0 0)"><path fill="currentColor" d="M17.7 332.3h412.7v22c0 37.7-29.3 68-65.3 68h-19L259.3 512v-89.7H83c-36 0-65.3-30.3-65.3-68v-22zm0-23.6h412.7v-85H17.7v85zm0-109.4h412.7v-85H17.7v85zM365 0H83C47 0 17.7 30.3 17.7 67.7V90h412.7V67.7C430.3 30.3 401 0 365 0z" transform="translate(-224 -256)"></path></g></g></svg></a><a href="https://www.instagram.com/shawntabrizi/" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="instagram" class="svg-inline--fa fa-instagram fa-inverse fa-3x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="transform-origin:0.4375em 0.5em"><g transform="translate(224 256)"><g transform="translate(0, 0)  scale(0.625, 0.625)  rotate(0 0 0)"><path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z" transform="translate(-224 -256)"></path></g></g></svg></a><a href="https://www.youtube.com/channel/UCl2YcZijUhWJweYeiOIYNdA" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="youtube" class="svg-inline--fa fa-youtube fa-inverse fa-3x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" style="transform-origin:0.5625em 0.5em"><g transform="translate(288 256)"><g transform="translate(0, 0)  scale(0.625, 0.625)  rotate(0 0 0)"><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z" transform="translate(-288 -256)"></path></g></g></svg></a><a href="mailto:shawntabrizi@gmail.com" target="_blank"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-inverse fa-3x" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="transform-origin:0.5em 0.5em"><g transform="translate(256 256)"><g transform="translate(0, 0)  scale(0.625, 0.625)  rotate(0 0 0)"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z" transform="translate(-256 -256)"></path></g></g></svg></a></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Shawn Tabrizi</div></div></div></footer></div>
</body>
</html>